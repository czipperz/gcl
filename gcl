#!/bin/bash
if (( $# < 1 )); then
    echo "Needs at least one argument"
    exit 1
fi
if [ 1 -eq $(echo "$1" | egrep -c "^(http(s)?|git|ssh)://*") ]; then
    git clone $@
elif [ 1 -eq $(echo "$1" | egrep -c "^[^:]+:.+") ]; then
    nnnn="$(echo "$1" | perl -pe 's/([^:]+:).+/$1/')"
    nn="$(cat $HOME/.config/git-providers | wc -l)"
    i=2
    while (( $i <= $nn )); do
	hi="$(head -n $i $HOME/.config/git-providers | tail -n 1)"
	if [ 1 -eq $(echo "$hi" | egrep -c "^$nnnn") ]; then
	    xD="$(echo "$1" | perl -pe 's/[^:]+:(.+)/$1/')"
	    shift
	    git clone $(echo "$hi" | perl -pe 's/[^:]+:(.+)/$1/')$xD $@
	    exit 0
	fi
	(( i++ ))
    done
    echo "Couldn't find provider $(echo "$nnnn" | perl -pe 's/:$//')"
else
    git clone $(head -n 1 $HOME/.config/git-providers)$@
fi
